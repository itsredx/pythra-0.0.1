<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Framework Reconciliation Test</title>
    <link rel="stylesheet" href="./js/scroll-bar/simplebar.min.css" />
    <link rel="stylesheet" href="styles.css?v=1752175467">
    <style id="dynamic-styles">.shared-scrollview-0 { display: flex; width: 100%; height: 100%; box-sizing: border-box; flex-direction: column; overflow-x: hidden; overflow-y: auto; }
.shared-scrollview-0 > * { flex-shrink: 0; }
.shared-container-4 { box-sizing: border-box; background: blue; border-radius: 20.0px; padding: 50px; }
.shared-column-1 { display: flex; flex-direction: column; justify-content: flex-start; align-items: flex-start; height: 100%; direction: ltr; }
.shared-container-0 { box-sizing: border-box; background: lightblue; border-radius: 20.0px; padding: 20px; }
.shared-row-0 { display: flex; flex-direction: row; justify-content: space-between; align-items: center; width: 100%; direction: ltr; }

            .shared-text-0 {
                margin: 0; /* Reset default paragraph margin */
                padding: 0;
                
                
                
            }
            
.shared-elevatedbutton-0 { display: inline-flex; align-items: center; justify-content: center; padding: 8px 16px; margin: 4px; border: none; border-radius: 6.0px; background-color: green; color: ash; cursor: pointer; text-align: center; text-decoration: none; outline: none; box-sizing: border-box; overflow: hidden; position: relative; transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.15s linear; -webkit-appearance: none; -moz-appearance: none; appearance: none; box-shadow: 0px 1.0px 2.0px 0px rgba(0,0,0,0.15), 0px 2.0px 4.0px 1px rgba(0,0,0,0.10); }
.shared-elevatedbutton-0:hover { box-shadow: 0px 1.5px 3.0px 0px rgba(0,0,0,0.18), 0px 3.0px 6.0px 1px rgba(0,0,0,0.13); /* Add background overlay? */ }
.shared-elevatedbutton-0:active { box-shadow: none; /* Add background overlay? */ }
.shared-elevatedbutton-0.disabled { background-color: rgba(0, 0, 0, 0.12); color: rgba(0, 0, 0, 0.38); box-shadow: none; cursor: default; pointer-events: none; }

.shared-elevatedbutton-1 { display: inline-flex; align-items: center; justify-content: center; padding: 8px 16px; margin: 4px; border: none; border-radius: 6.0px; background-color: coral; color: ash; cursor: pointer; text-align: center; text-decoration: none; outline: none; box-sizing: border-box; overflow: hidden; position: relative; transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.15s linear; -webkit-appearance: none; -moz-appearance: none; appearance: none; box-shadow: 0px 1.0px 2.0px 0px rgba(0,0,0,0.15), 0px 2.0px 4.0px 1px rgba(0,0,0,0.10); }
.shared-elevatedbutton-1:hover { box-shadow: 0px 1.5px 3.0px 0px rgba(0,0,0,0.18), 0px 3.0px 6.0px 1px rgba(0,0,0,0.13); /* Add background overlay? */ }
.shared-elevatedbutton-1:active { box-shadow: none; /* Add background overlay? */ }
.shared-elevatedbutton-1.disabled { background-color: rgba(0, 0, 0, 0.12); color: rgba(0, 0, 0, 0.38); box-shadow: none; cursor: default; pointer-events: none; }

.shared-row-1 { display: flex; flex-direction: row; justify-content: space-around; align-items: center; width: 100%; direction: ltr; }
.shared-elevatedbutton-2 { display: inline-flex; align-items: center; justify-content: center; padding: 8px 16px; margin: 4px; border: none; border-radius: 6.0px; background-color: hotpink; color: ash; cursor: pointer; text-align: center; text-decoration: none; outline: none; box-sizing: border-box; overflow: hidden; position: relative; transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.15s linear; -webkit-appearance: none; -moz-appearance: none; appearance: none; box-shadow: 0px 1.0px 2.0px 0px rgba(0,0,0,0.15), 0px 2.0px 4.0px 1px rgba(0,0,0,0.10); }
.shared-elevatedbutton-2:hover { box-shadow: 0px 1.5px 3.0px 0px rgba(0,0,0,0.18), 0px 3.0px 6.0px 1px rgba(0,0,0,0.13); /* Add background overlay? */ }
.shared-elevatedbutton-2:active { box-shadow: none; /* Add background overlay? */ }
.shared-elevatedbutton-2.disabled { background-color: rgba(0, 0, 0, 0.12); color: rgba(0, 0, 0, 0.38); box-shadow: none; cursor: default; pointer-events: none; }

.shared-container-1 { box-sizing: border-box; height: 40px; }
.shared-elevatedbutton-3 { display: inline-flex; align-items: center; justify-content: center; padding: 8px 16px; margin: 4px; border: none; border-radius: 6.0px; background-color: khaki; color: ash; cursor: pointer; text-align: center; text-decoration: none; outline: none; box-sizing: border-box; overflow: hidden; position: relative; transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.15s linear; -webkit-appearance: none; -moz-appearance: none; appearance: none; box-shadow: 0px 1.0px 2.0px 0px rgba(0,0,0,0.15), 0px 2.0px 4.0px 1px rgba(0,0,0,0.10); }
.shared-elevatedbutton-3:hover { box-shadow: 0px 1.5px 3.0px 0px rgba(0,0,0,0.18), 0px 3.0px 6.0px 1px rgba(0,0,0,0.13); /* Add background overlay? */ }
.shared-elevatedbutton-3:active { box-shadow: none; /* Add background overlay? */ }
.shared-elevatedbutton-3.disabled { background-color: rgba(0, 0, 0, 0.12); color: rgba(0, 0, 0, 0.38); box-shadow: none; cursor: default; pointer-events: none; }

.shared-container-2 { box-sizing: border-box; }
.shared-container-3 { box-sizing: border-box; height: 20px; }
.shared-column-0 { display: flex; flex-direction: column; justify-content: flex-start; align-items: center; height: 100%; direction: ltr; }

                .selected { /* Base styles */ }
                .selected > :first-child { /* Styles for Leading */ }
                .selected > :last-child { /* Styles for Trailing */ }
                .selected > :nth-child(2) { /* Styles for Title */ }
                .selected.has-subtitle > :nth-child(3) { /* Styles for Subtitle */ }
                /* etc. */
            

                .shared-listtile-0 { /* Base styles */ }
                .shared-listtile-0 > :first-child { /* Styles for Leading */ }
                .shared-listtile-0 > :last-child { /* Styles for Trailing */ }
                .shared-listtile-0 > :nth-child(2) { /* Styles for Title */ }
                .shared-listtile-0.has-subtitle > :nth-child(3) { /* Styles for Subtitle */ }
                /* etc. */
            
.shared-iconbutton-0 { display: inline-flex; align-items: center; justify-content: center; padding: 8px; margin: 0; border: none; background-color: None; color: None; cursor: pointer; outline: none; border-radius: 50%; overflow: hidden; position: relative; box-sizing: border-box; transition: background-color 0.15s linear; -webkit-appearance: none; appearance: none; width: calc(24px + 16px); height: calc(24px + 16px); }

            .shared-iconbutton-0 > i, .shared-iconbutton-0 > img, .shared-iconbutton-0 > svg, .shared-iconbutton-0 > * {
                font-size: 24px;
                width: 24px;
                height: 24px;
                display: block;
                object-fit: contain;
            }
.shared-iconbutton-0:hover { background-color: rgba(0, 0, 0, 0.08); }
.shared-iconbutton-0:active { background-color: rgba(0, 0, 0, 0.12); }
.shared-iconbutton-0.disabled { color: rgba(0, 0, 0, 0.38); background-color: transparent; cursor: default; pointer-events: none; }

                .material-icon-0 {
                    position: relative;
                    font-family: 'Material Symbols Rounded';
                    font-weight: normal;
                    font-style: normal;
                    font-size: 24px;
                    line-height: 1;
                    letter-spacing: normal;
                    text-transform: none;
                    z-index: 100;
                    display: inline-block;
                    white-space: nowrap;
                    word-wrap: normal;
                    direction: ltr;
                    -webkit-font-smoothing: antialiased;
                    text-rendering: optimizeLegibility;
                    -moz-osx-font-smoothing: grayscale;
                    font-feature-settings: 'liga';
                    color: #625B71;
                    font-variation-settings: 'FILL' 1, 'wght' 700, 'GRAD' 0, 'opsz' 24;
                }
            
.shared-fab-0 { display: inline-flex; align-items: center; justify-content: center; position: fixed; bottom: 16px; right: 16px; width: 56px; height: 56px; padding: 16px; margin: 0; border: none; border-radius: 28.0px; background-color: #EADDFF; color: #21005D; cursor: pointer; text-decoration: none; outline: none; box-sizing: border-box; overflow: hidden; transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1), transform 0.15s ease-out, background-color 0.15s linear; -webkit-appearance: none; moz-appearance: none; appearance: none; z-index: 1000; box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2), 0px 6px 10px 0px rgba(0,0,0,0.14), 0px 1px 18px 0px rgba(0,0,0,0.12); }

            .shared-fab-0 > i, /* Font Awesome */
            .shared-fab-0 > img, /* Custom Image */
            .shared-fab-0 > svg, /* SVG Icon */
            .shared-fab-0 > * { /* General direct child */
                display: block; /* Prevent extra space */
                width: 24px; /* M3 Standard icon size */
                height: 24px;
                object-fit: contain; /* For img/svg */
                /* Color is inherited from button */
            }
.shared-fab-0:hover { box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2), 0px 7px 10px 1px rgba(0,0,0,0.14), 0px 2px 16px 1px rgba(0,0,0,0.12); }
.shared-fab-0:active { transform: scale(0.98); /* Example subtle press */ }
.shared-fab-0.disabled { background-color: grey; color: grey; box-shadow: none; cursor: default; pointer-events: none; }</style>
    
        <script src="qwebchannel.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                new QWebChannel(qt.webChannelTransport, (channel) => {
                    window.pywebview = channel.objects.pywebview;
                    console.log("PyWebChannel connected.");
                });
            });
            function handleClick(name) { if(window.pywebview) window.pywebview.on_pressed_str(name); }
            function handleItemTap(name, index) { if(window.pywebview) window.pywebview.on_pressed(name, index); }
            function handleInput(name, value) { if(window.pywebview) window.pywebview.on_input_changed(name, value); }
        </script>
        
</head>
<body>
    <div id="root-container"><div id="pythra_id_1" class="shared-scrollview-0"><div id="pythra_id_2" class="shared-container-4"><div id="pythra_id_3" class="shared-column-1"><div id="pythra_id_4" class="shared-container-0"><div id="pythra_id_5" class="shared-row-0"><p id="pythra_id_6" class="shared-text-0">Counter: 0</p><button id="pythra_id_7" class="shared-elevatedbutton-0" onclick="handleClick('increment')"><p id="pythra_id_8" class="shared-text-0">Increment</p></button><button id="pythra_id_9" class="shared-elevatedbutton-1" onclick="handleClick('decrement')"><p id="pythra_id_10" class="shared-text-0">Decrement</p></button></div></div><div id="pythra_id_11" class=""></div><div id="pythra_id_12" class="shared-row-1"><button id="pythra_id_13" class="shared-elevatedbutton-2" onclick="handleClick('add_item')"><p id="pythra_id_14" class="shared-text-0">Add Item</p></button><button id="pythra_id_15" class="shared-elevatedbutton-2" onclick="handleClick('swap_items')"><p id="pythra_id_16" class="shared-text-0">Swap First Two</p></button><button id="pythra_id_17" class="shared-elevatedbutton-2" onclick="handleClick('remove_last_item')"><p id="pythra_id_18" class="shared-text-0">Remove Last</p></button><button id="pythra_id_19" class="shared-elevatedbutton-2" onclick="handleClick('remove_first_item')"><p id="pythra_id_20" class="shared-text-0">Remove First</p></button></div><div id="pythra_id_21" class="shared-container-1"></div><button id="pythra_id_22" class="shared-elevatedbutton-3" onclick="handleClick('toggle_extra')"><p id="pythra_id_23" class="shared-text-0">Toggle Extra Text</p></button><div id="pythra_id_24" class="shared-container-1"></div><div id="pythra_id_25" class="shared-container-2"></div><div id="pythra_id_26" class="shared-container-3"></div><div id="pythra_id_27" class=""></div><p id="pythra_id_28" class="shared-text-0">Item List:</p><div id="pythra_id_29" class="shared-container-1"></div><div id="pythra_id_30" class="shared-column-0"><div id="pythra_id_31" class="shared-listtile-0 selected " onclick="handleClick('')"><p id="pythra_id_32" class="shared-text-0">Apple 🍎</p><button id="pythra_id_33" class="shared-iconbutton-0 " onclick="handleClick('remove_apple')"><i id="pythra_id_34" class="material-icon-0">settings</i></button></div><div id="pythra_id_35" class="shared-listtile-0  " onclick="handleClick('')"><p id="pythra_id_36" class="shared-text-0">Banana 🍌</p><button id="pythra_id_37" class="shared-iconbutton-0 " onclick="handleClick('remove_banana')"><i id="pythra_id_38" class="material-icon-0">settings</i></button></div><div id="pythra_id_39" class="shared-listtile-0  " onclick="handleClick('')"><p id="pythra_id_40" class="shared-text-0">Cherry 🍒</p><button id="pythra_id_41" class="shared-iconbutton-0 " onclick="handleClick('remove_cherry')"><i id="pythra_id_42" class="material-icon-0">settings</i></button></div></div><button id="pythra_id_43" class="shared-fab-0"></button></div></div></div></div>
    <div id="overlay-container"></div>
    <script src="./js/scroll-bar/simplebar.min.js"></script>
    
        <script>
            // This script block contains core helper functions that are always needed.
            // Embedding them here avoids re-sending them with every patch.
            
            // --- Responsive Clip Path Engine ---
            var vec = (p1, p2) => ({ x: p2.x - p1.x, y: p2.y - p1.y });
            var magnitude = (v) => Math.sqrt(v.x ** 2 + v.y ** 2);
            var dot = (v1, v2) => v1.x * v2.x + v1.y * v2.y;
            var cross = (v1, v2) => v1.x * v2.y - v1.y * v2.x;
            var round = (val) => Math.round(val * 100) / 100; // Round to 2 decimal places

            function generateRoundedPath(points, radius) {
                const numPoints = points.length;
                const cornerData = [];

                console.log(`>>>>>> Generator Initiated <<<<<<`)

                for (let i = 0; i < numPoints; i++) {
                    const p_prev = points[(i + numPoints - 1) % numPoints];
                    const p_curr = points[i];
                    const p_next = points[(i + 1) % numPoints];

                    const v1 = vec(p_curr, p_prev);
                    const v2 = vec(p_curr, p_next);
                    const v1_mag = magnitude(v1);
                    const v2_mag = magnitude(v2);

                    if (v1_mag === 0 || v2_mag === 0) {
                        cornerData.push({ t1: p_curr, t2: p_curr, radius: 0 });
                        continue;
                    }

                    const angle = Math.acos(Math.max(-1, Math.min(1, dot(v1, v2) / (v1_mag * v2_mag))));
                    let tangentDist = radius / Math.tan(angle / 2);
                    tangentDist = Math.min(tangentDist, v1_mag / 2, v2_mag / 2);
                    const clampedRadius = Math.abs(tangentDist * Math.tan(angle / 2));

                    const t1 = { x: p_curr.x + (v1.x / v1_mag) * tangentDist, y: p_curr.y + (v1.y / v1_mag) * tangentDist };
                    const t2 = { x: p_curr.x + (v2.x / v2_mag) * tangentDist, y: p_curr.y + (v2.y / v2_mag) * tangentDist };

                    const sweepFlag = cross(v1, v2) < 0 ? 1 : 0;

                    cornerData.push({ t1, t2, radius: clampedRadius, sweepFlag });
                }

                const pathCommands = [];
                pathCommands.push(`M ${round(cornerData[numPoints - 1].t2.x)} ${round(cornerData[numPoints - 1].t2.y)}`);
                for (let i = 0; i < numPoints; i++) {
                    const corner = cornerData[i];
                    pathCommands.push(`L ${round(corner.t1.x)} ${round(corner.t1.y)}`);
                    pathCommands.push(`A ${round(corner.radius)} ${round(corner.radius)} 0 0 ${corner.sweepFlag} ${round(corner.t2.x)} ${round(corner.t2.y)}`);
                }
                pathCommands.push('Z');
                console.log(pathCommands.join(' '));
                return pathCommands.join(' ');
            }


            function scalePathAbsoluteMLA(pathStr, refW, refH, targetW, targetH, options = {}) {
            const rw = targetW / refW;
            const rh = targetH / refH;
            const uniformArc = !!options.uniformArc;
            const decimalPlaces = typeof options.decimalPlaces === 'number' ? options.decimalPlaces : null;
            const rScale = uniformArc ? Math.min(rw, rh) : null;

            const fmt = (num) => {
                return decimalPlaces !== null
                ? Number(num.toFixed(decimalPlaces)).toString()
                : Number(num).toString();
            };

            // Normalize the string
            const s = pathStr
                .replace(/,/g, ' ')
                .replace(/([0-9])-/g, '$1 -')
                .replace(/\s+/g, ' ')
                .trim();

            const tokenRegex = /([MLAZHV])|(-?\d*\.?\d+(?:e[-+]?\d+)?)/gi;
            const tokens = [];
            let match;
            while ((match = tokenRegex.exec(s)) !== null) {
                tokens.push(match[1] || match[2]);
            }

            const out = [];
            let i = 0;
            while (i < tokens.length) {
                const cmd = tokens[i++];
                out.push(cmd);

                switch (cmd) {
                case 'M':
                case 'L':
                    while (i + 1 < tokens.length && !/^[MLAZHV]$/.test(tokens[i])) {
                    const x = parseFloat(tokens[i++]) * rw;
                    const y = parseFloat(tokens[i++]) * rh;
                    out.push(fmt(x), fmt(y));
                    }
                    break;

                case 'A':
                    while (i + 6 < tokens.length && !/^[MLAZHV]$/.test(tokens[i])) {
                    const rx = parseFloat(tokens[i++]);
                    const ry = parseFloat(tokens[i++]);
                    const rot = tokens[i++];
                    const laf = tokens[i++];
                    const sf = tokens[i++];
                    const x = parseFloat(tokens[i++]);
                    const y = parseFloat(tokens[i++]);

                    out.push(
                        fmt(uniformArc ? rx * rScale : rx * rw),
                        fmt(uniformArc ? ry * rScale : ry * rh),
                        rot,
                        laf,
                        sf,
                        fmt(x * rw),
                        fmt(y * rh)
                    );
                    }
                    break;

                case 'H':
                    while (i < tokens.length && !/^[MLAZHV]$/.test(tokens[i])) {
                    const x = parseFloat(tokens[i++]) * rw;
                    out.push(fmt(x));
                    }
                    break;

                case 'V':
                    while (i < tokens.length && !/^[MLAZHV]$/.test(tokens[i])) {
                    const y = parseFloat(tokens[i++]) * rh;
                    out.push(fmt(y));
                    }
                    break;

                case 'Z':
                    // No coordinates to scale
                    break;

                default:
                    console.warn('Unsupported or unexpected token:', cmd);
                }
            }

            return out.join(' ');
            }

            class ResponsiveClipPath {
            constructor(target, originalPath, refW, refH, options = {}) {
                this.elements = [];
                this.orig = originalPath.trim();
                this.refW = refW;
                this.refH = refH;
                this.options = options;
                this.currentPath = "";  // ⬅️ Store last computed path string
                this.update = this.update.bind(this);
                this.roList = [];

                if (typeof target === 'string') {
                let selector = target;
                if (!selector.startsWith('#') && !selector.startsWith('.')) {
                    const byId = document.getElementById(selector);
                    selector = byId ? `#${selector}` : `.${selector}`;
                }
                const nodeList = document.querySelectorAll(selector);
                if (nodeList.length === 0) {
                    console.warn(`ResponsiveClipPath: no elements found for selector "${selector}"`);
                }
                nodeList.forEach(el => this.elements.push(el));
                } else if (target instanceof HTMLElement) {
                this.elements.push(target);
                } else {
                console.warn('ResponsiveClipPath: invalid target', target);
                }

                this.elements.forEach(el => this.initElement(el));
            }

            initElement(el) {
                this.applyClip(el);
                if (window.ResizeObserver) {
                const ro = new ResizeObserver(() => this.applyClip(el));
                ro.observe(el);
                this.roList.push({ el, ro });
                } else {
                window.addEventListener('resize', this.update);
                }
            }

            applyClip(el) {
                const rect = el.getBoundingClientRect();
                const newPath = scalePathAbsoluteMLA(
                this.orig,
                this.refW,
                this.refH,
                rect.width,
                rect.height,
                this.options
                );
                this.currentPath = `path("${newPath}")`;  // ⬅️ Save it
                el.style.clipPath = this.currentPath;
                el.style.webkitClipPath = this.currentPath;
            }

            update() {
                this.elements.forEach(el => this.applyClip(el));
            }

            disconnect() {
                this.roList.forEach(({ el, ro }) => ro.unobserve(el));
                this.roList = [];
                window.removeEventListener('resize', this.update);
            }

            // ✅ Your new method
            getResponsivePath() {
                return this.currentPath;
            }
            }
        </script>
        
    
        <script type="module">
            document.addEventListener('DOMContentLoaded', () => {
                window._pythra_instances = window._pythra_instances || {};
                
            });
        </script>
        
</body>
</html>